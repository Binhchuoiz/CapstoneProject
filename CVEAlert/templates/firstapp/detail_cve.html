{% extends 'navbar.html' %}


{% block css %}
    a {
    text-decoration: none;
    color: black;
    }
    input, textarea {
    width: 100%;
    border-radius: 5px;
    margin-bottom: 20px;
    padding: 10px;
    }
    .title-box > * {
    padding: 10px;
    background-color: black !important;
    color: white !important;
    border-top-right-radius: 10px !important;
    border-top-left-radius: 10px !important;
    margin: 0;
    }
    .box-info {
        margin-bottom: 20px;
        margin-top: 20px;
    }
    .content-box {
    background-color: lightgray !important;
    border-bottom-right-radius: 10px;
    border-bottom-left-radius: 10px;
    margin: 0;
    padding: 10px;
    }
    .base-score {
    background-color: white ;
    color: black !important;
    padding: 20px;
    width:100%;
    border-radius: 10px;
    align:right;
    }
    .alert-msg {
        background-color: lightgreen;
        color: white;
        padding: 10px;
        border-radius: 5px;
        border-color: red;
    }

    /*=READ NOW=*/
.btn {
    line-height: 20px;
    height: 50px;
    text-align: center;
    text-style:bold
    cursor: pointer;
    background-color:black;
  }
  .btn-one {
    color: white;
    transition: all 0.5s;
    position: relative;
  }
  .btn-one span {
    transition: all 0.5s;
  }
  .btn-one::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 2;
    opacity: 0;
    transition: all 1s;
    border-top-width: 1px;
    border-bottom-width: 1px;
    border-top-style: solid;
    border-bottom-style: solid;
    border-top-color: black;
    border-bottom-color: black;
    transform: scale(0.1, 1);
    
  }
  .btn-one:hover span {
    letter-spacing: 2px;
  }
  .btn-one:hover::before {
    opacity: 1; 
    transform: scale(1, 1); 
  }
  .btn-one::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    transition: all 0.3s;
    background-color: rgba(255,255,255,0.1);
  }
  .btn-one:hover::after {
    opacity: 0; 
    transform: scale(0.1, 1);
  }
  /*=URL=*/
.url{
    a {
        color: black;
      position: relative;
      text-decoration: none;
    }
    
    a::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 2px;
      border-radius: 4px;
      background-color: #18272F;
      bottom: 0;
      left: 0;
      transform-origin: right;
      transform: scaleX(0);
      transition: transform .3s ease-in-out;
    }
}

a:hover::before {
  transform-origin: left;
  transform: scaleX(1);
}

/*=Link list=*/
  .list{
      a {
          box-shadow: inset 0 0 0 0 black;
          color: black;
            padding: 0 .25rem;
            margin: 0 -.25rem;
            left:10%;
            border-radius: 5px;
          transition: color .5s ease-in-out, box-shadow .5s ease-in-out;
        }
        a:hover {
          color: white;
          box-shadow: inset 200px 0 0 0 black;;
        }
        
        /* Presentational styles */
        a {
          color: black;
          font-size: 19px;
          font-weight: 500;
          line-height: 0;
          text-decoration: none;
        }
  }



  /*=arrow=*/
.arrow {
    position: absolute;
    top: 19%;
    left: 14%;
    transform: translate(-50%, -50%);
    transform: rotate(90deg);
    cursor: pointer;
}

.arrow span {
    display: block;
    width: 1vw;
    height: 1vw;
    border-bottom: 5px solid black;
    border-right: 5px solid black;
    transform: rotate(45deg);
    margin: -10px;
    animation: animate 2s infinite;
}

.arrow span:nth-child(2) {
    animation-delay: -0.2s;
}

.arrow span:nth-child(3) {
    animation-delay: -0.4s;
}

@keyframes animate {
    0% {
        opacity: 0;
        transform: rotate(45deg) translate(-20px, -20px);
    }
    50% {
        opacity: 1;
    }
    100% {
        opacity: 0;
        transform: rotate(45deg) translate(20px, 20px);
    }
}

/*= NOTIFICATIONS=*/
@import url('https://fonts.googleapis.com/css?family=Montserrat:600&display=swap');

span{
position: relative;
display: inline-flex;
width: -10px;
height: 55px;
margin: 0 5px;
perspective: 1000px;
}
span a{
font-size: 15px;
font-style:bold;
letter-spacing: 1px;
transform-style: preserve-3d;
transform: translateZ(-25px);
transition: transform .25s;

}
span a:before,
span a:after{
position: absolute;
content: "Click here to see full how to read an CVE! ";
height: 55px;
width: 180px;
display: flex;
align-items: center;
justify-content: center;
border: 5px solid black;
box-sizing: border-box;
border-radius: 5px;
text-align:center;  
}
span a:before{
color: #fff;
background: #000;
transform: rotateY(0deg) translateZ(25px);
}
span a:after{
color: #000;
transform: rotateX(90deg) translateZ(25px);
}
span a:hover{
transform: translateZ(-25px) rotateX(-90deg);
}


.accordion {
    background-color: black;
    color: white;
    cursor: pointer;
    padding: 18px;
    width: 100%;
    border: none;
    text-align: left;
    outline: none;
    font-size: 22px;
    transition: 0.4s;
  }
  
  .active, .accordion:hover {
    background-color: black;
  }
  
  .accordion:after {
    content: '\002B';
    color: white;
    font-weight: bold;
    float: right;
    margin-left: 5px;
  }
  
  .active:after {
    content: "\2212";
  }
  
  .panel {
    padding: 0 18px;
    background-color: black ;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s ease-out;
  }
  
/*=URL=*/
.url{
    a {
    color: blue;
      position: relative;
      text-decoration: none;
    }
    
    a::before {
      content: '';
      position: absolute;
      width: 100%;
      height: 2px;
      border-radius: 4px;
      background-color: #18272F;
      bottom: 0;
      left: 0;
      transform-origin: right;
      transform: scaleX(0);
      transition: transform .3s ease-in-out;
    }
}

a:hover::before {
  transform-origin: left;
  transform: scaleX(1);
}
abbr {
  font-style: italic;
  position: relative
}

{% endblock %}


{% block title %}
    Detail CVEs
{% endblock %}


{% block content %}
{# Thêm logic để hiện thị các trường của CVE #}
<div class="container" style="margin-top: 100px; margin-bottom: 200px">
    <p class="list"><a href={% url 'app:list_cves' page=1 %}>Explore CVE list</a></p>
    <div class="arrow" onclick="goBack()">
        <span></span>
        <span></span>
        <span></span>
    </div>
    <script>
        function goBack() {
            window.history.back();
        }
    </script>
    <div class="row">
        <div class="col-8">
            <h1><b>{{ detail_cve.cve_id }}</b></h1>
            <div class="box-info">
                <div class="title-box">
                    <h2><b style="font-size: 28px;">DESCRIPTION </b></h2>
                </div>
                <div class="content-box">
                    <p><abbr title="Description (DESCRIPTION) is an important part of the Common Vulnerabilities and Exposures (CVE) identifier, providing a detailed summary of the nature of the vulnerability and how it operates."><i class="fa-solid fa-info-circle" ></i></abbr> {{ descriptions.value }}</p>
                </div>
            </div>
            <div class="box-info">
                <div class="title-box">
                    <h2><b style="font-size: 28px;">Vulnerable products, Vendor, Version </b></h2>
                </div>
                <div class="content-box">
                        {% for a in affected %} 
                            {% if a.con_id == detail_cve.id %}
                            <form id="click_product_form" method="post" action="{% url 'accounts:list_cve_by_product' %}">
                              {% csrf_token %}
                              <!-- Input ẩn để lưu trữ giá trị productName -->
                              <input type="hidden" name="click_product" id="click_product_input">
                              <p class="url"><b> <abbr title="Although the Common Vulnerabilities and Exposures (CVE) format does not include a separate 'product name' field, it does contain information about the affected product. This information is often more detailed than a general product catalog."><i class="fa-solid fa-info-circle" ></i></abbr> Product: </b>"{{ a.product.name }}"
                              <a href="#" class="product-link" data-product-name="{{ a.product.name }}">
                              
                              
                                   <i>(Click here to see related cves!)</i>
                              </a>
                              
                            </p>
                          </form>
                                <p><b><abbr title="Vendor field in the CVE (Common Vulnerabilities and Exposures) format identifies the software or hardware vendor responsible for the product affected by the described vulnerability."><i class="fa-solid fa-info-circle" ></i></abbr> Vendor name: </b>{{ a.vendor.name }}</p>
                               
                            {% endif %}
                            {% comment %} {% for p in products_versions %} 
                                {% if p.product_id == a.product.id %}
                                    <p><b>+ Version:</b> {{ p.version.version }}</p>
                                {% endif %}
                            {% endfor %} {% endcomment %}
                        {% endfor %}
                        {% for p in products_versions %} 
                        {% if p.con_id == detail_cve.id %}
                        <p><b><abbr title="Version field in the CVE (Common Vulnerabilities and Exposures) format identifies the specific version of the software or hardware product affected by the described vulnerability."><i class="fa-solid fa-info-circle" ></i></abbr> Versions: </b>{{ p.version.version }}</p>
                        {% endif %}
                        {% endfor %}
                </div>
            </div>
            <div class="box-info">
              <div class="title-box">
                  <h2><b style="font-size: 28px;">Exploits & ProblemTypes </b></h2>
              </div>
              <div class="content-box url">
                <p><b><abbr title="Although the Common Vulnerabilities and Exposures (CVE) format does not include an official 'Exploits' field, there are still ways to find information about available exploits for a specific CVE vulnerability."><i class="fa-solid fa-info-circle" ></i></abbr> Exploits: </b>{{ exploits.value }}</p>
                  {% comment %} <p><b>- ProblemTypes: </b>{{ problemTypes.cwe_id }}</p> {% endcomment %}
                  {% for p in problemTypes_cve %} 
                  {% if p.con_id == detail_cve.id %}
                  <form id="click_problem_form" method="post" action="{% url 'app:list_cves_by_problem' %}">
                    {% csrf_token %}
                    <!-- Input ẩn để lưu trữ giá trị productName -->
                    <input type="hidden" name="click_problem" id="click_problem_input">
                    <p class="url"><b><abbr title="ProblemType refers to a standardized way of classifying the type of vulnerability based on how it can be exploited. It helps categorize vulnerabilities and understand their potential impact on systems."><i class="fa-solid fa-info-circle" ></i></abbr> ProblemTypes Description: </b>"{{ p.problemTypes.description }} "
                    <a href="{% url 'app:list_cves_by_problem' %}" class="problem-link" data-problem-name="{{ p.problemTypes.description }}">
                         <i>(Click here to see related cves!)</i>
                    </a>
                  </p>
                </form>
                  {% endif %}
                  {% endfor %}
              </div>
          </div>
            <div class="box-info">
                <div class="title-box">
                    <h2><b style="font-size: 28px;">Solution, References, Work Around  </b></h2>
                </div>
                <div class="content-box url">
                  <p><b><abbr title="Workaround is a temporary solution to mitigate the risks associated with the vulnerability described in the Common Vulnerabilities and Exposures (CVE) log."><i class="fa-solid fa-info-circle" ></i></abbr> Work Around: </b>{{ workaround.value }}</p>
                    <p><b><abbr title="The 'Solutions' field in a CVE (Common Vulnerabilities and Exposures) entry doesn't have a standardized format or content across different sources. However, it generally provides information about how to address the vulnerability and reduce the associated risks."><i class="fa-solid fa-info-circle" ></i></abbr> Solution: </b>{{ solutions.value }}</p>
                    {% for r in refrences %}
                        {% if r.con_id == detail_cve.id %}
                        <b><abbr title="A CVE (Common Vulnerabilities and Exposures) URL is a unique link to the official CVE website that provides detailed information about a specific security vulnerability. This URL is created according to the following structure: 'https://nvd.nist.gov/vuln/detail/(CVE-ID)'"><i class="fa-solid fa-info-circle" ></i></abbr> URL:</b><a href="{{ r.url }}"> {{ r.url }}</a>
                </br>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            
        </div>
        <div class="col-4">
            <div class="box-info" style="margin-top:65px;">
                <div class="title-box">
                    <h2><b style="font-size: 28px;">CVE Informations </b></h2>
                </div>
                <div class="content-box" >
                    <form method="post">
                        {% csrf_token %}
                        <p><b><abbr title="CVE ID stands for Common Vulnerabilities and Exposures Identifier, also known as Common Vulnerability Identifier."><i class="fa-solid fa-info-circle" ></i></abbr> CVE ID:</b> {{ detail_cve.cve_id }}</p>
                        <p><b><abbr title="(Date made public) of a CVE."><i class="fa-solid fa-info-circle" ></i></abbr> Published Date:</b> {{ detail_cve.date_publish }}</p>
                        <p><b><abbr title=" CVE 'Recently updated' date."><i class="fa-solid fa-info-circle" ></i></abbr> Date Update: </b> {{ detail_cve.date_update }}</p>
                        <p><b><abbr title="In a CVE entry, 'Date Reserved' signifies the official reservation of a unique ID (CVE-ID) for a reported security flaw. This kickstarts the process of documenting and tracking the vulnerability across different security platforms."><i class="fa-solid fa-info-circle" ></i></abbr> Date Reserved:</b> {{ detail_cve.date_reserved }}</p>
                        <p><b><abbr title="The 'Data Version' in a CVE (Common Vulnerabilities and Exposures) entry typically refers to the version of the CVE data schema or format used to represent the information about the vulnerability. This version number indicates the specific format or structure used to encode and store the CVE entry. It helps in understanding how the information is organized and interpreted within CVE databases and tools. As the CVE data schema evolves over time to accommodate new requirements or improvements, the data version helps ensure compatibility and consistency across different implementations and releases."><i class="fa-solid fa-info-circle" ></i></abbr> Data Version:</b> {{ detail_cve.data_version }}</p>
                        <p><b><abbr title=" In a CVE (Common Vulnerabilities and Exposures) entry, the 'Organization ID' typically refers to a unique identifier assigned to the organization or entity that reported or disclosed the vulnerability associated with that CVE. This ID helps to identify the entity responsible for discovering, reporting, or coordinating the response to the vulnerability. It aids in tracking and attributing the source of the vulnerability information within the CVE ecosystem."><i class="fa-solid fa-info-circle" ></i></abbr> Organization ID: </b> {{ detail_cve.assigner_org_id }}</p>
                        <p><b><abbr title="In a CVE (Common Vulnerabilities and Exposures) entry, the 'Organization Short Name' typically refers to the organization or vendor that discovered or reported the vulnerability associated with that CVE. It is a way to attribute the discovery or reporting of the vulnerability to a specific entity. This information helps in understanding who identified the vulnerability and can be useful for further investigation or collaboration between different organizations working on cybersecurity issues."><i class="fa-solid fa-info-circle" ></i></abbr> Organization Short Name:</b> {{ detail_cve.assigner_short_name }}</p>
                            <input name="follow_affect" value="null" style="display: none">
                            <input name="follow_affect" value="null" style="display: none">
                        <span><a href="{% url 'app:guidelines' %}" ></a></span>   
                    </form>
                </div>
            </div>
            <br>
            <button class="accordion"><b id="6"><abbr title="FULL CVSS SCORE REFERENCES(CVSS V2.0 to CVSS V3.0)."><i class="fa-solid fa-info-circle" ></i></abbr> FULL CVSS SCORE REFERENCES</b></button>
                <div class=" panel" style="background-color: lightgray;">
                  <p style="color: black;"><b>Base Score:</b> The Base Score of a CVE (Common Vulnerabilities and Exposures) in CVSS v3.1 reflects the overall severity of the vulnerability.</p>
                  <p style="color: black;"><b></b>➡️ "It's a numerical value (0.0 to 10.0)."</p> 
                  <hr>
                  <p style="color: black;"><b>Vector String:</b>  The CVSS v3.1 vector string is a text representation of a set of CVSS metrics. It is commonly used to record or transfer CVSS metric information in a concise form.</p> 
                  <p style="color: black;"><b></b>➡️ "Exploit: (AV, AC, PR, UI)"</p> 
                 
                  <p style="color: black;"><b></b>➡️ "Impact: (C, I, A), S"</p> 
                  <hr>
                  <p style="color: black;"><b>Base Severity:</b>The Base severity of a vulnerability.</p> 
                 
                  <p style="color: black;"><b></b>➡️ "Metric Value: (Low, High, Medium, Critical)"</p> 
                  <hr>
                  <p style="color: black;"><b>Attack Complexity:</b> This metric describes the conditions beyond the attacker’s control that must exist in order to exploit the vulnerability.</p> 
                  
                  <p style="color: black;"><b></b>➡️ "Metric Value: ( Low (L), High (H))"</p> 
                  <hr>
                  <p style="color: black;"><b>Attack Vector:</b>This metric reflects the context by which vulnerability exploitation is possible.</p> 
                 
                  <p style="color: black;"><b></b>➡️ "Metric Value: (Network (N), Adjacent (A), Local (L), Physical (P))"</p> 
                  <hr>
                  <p style="color: black;"><b>Availability Impact:</b >This metric measures the impact to the availability of the impacted component resulting from a successfully exploited vulnerability.</p> 
                  <p style="color: black;"><b></b>➡️ "Metric Value: (None (N), Low (L), High (H))"</p>
                  <hr> 
                  <p style="color: black;"><b>Confidentiality Impact:</b> This metric measures the impact to the confidentiality of the information resources managed by a software component due to a successfully exploited vulnerability. </p> 
                  <p style="color: black;"><b></b>➡️ "Metric Value: (None (N), Low (L), High (H))"</p> 
                  <hr>
                  <p style="color: black;"><b>Integrity Impact:</b>This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information.</p> 
                  <p style="color: black;"><b></b>➡️ "Metric Value: (None (N), Low (L), High (H))"</p> 
                  <hr>
                  <p style="color: black;"><b>Privileges Required: </b>This metric describes the level of privileges an attacker must possess before successfully exploiting the vulnerability.</p> 
                  <p style="color: black;"><b></b>➡️ "Metric Value: (None (N), Low (L), High (H))"</p> 
                  <hr>
                  <p style="color: black;"><b>Scope Of:</b>The Scope metric captures whether a vulnerability in one vulnerable component impacts resources in components beyond its security scope.</p> 
                  <p style="color: black;"><b></b>➡️ "Metric Value: (Unchanged (U), Changed (C))"</p> 
                  <hr>
                  <p style="color: black;"><b>User Interaction:</b>This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable component</p> 
                  <p style="color: black;"><b></b>➡️ "Metric Value: (None (N), Required (R))"</p> 
                </div>      
            </br>
                <button class="accordion"><b>CVSS V3.1</b></button>
                <div class="panel">
                    {% for m in metric %}
                    {% if m.con_id == detail_cve.id  and m.cvssv31.base_score is not none and m.cvssv31.base_severity is not none%}
                        <span style="float: right">{{ m.cvssv31.base_score }}</span>
                    </br>
                        {% comment %} <span style="float: right">{{ m.cvssv20.base_score }}</span> {% endcomment %}
                        <p class="base-score"> <b style="font-size: 20px;">Base Score: "{{ m.cvssv31.base_score }}"</b>
                        </p></br>
                        <p class="base-score"> <b style="font-size: 20px;">Vector String: "{{ m.cvssv31.vector_string }}"</b> 
                        </p></br>
                        {% if m.cvssv31.base_score > 0 and m.cvssv31.base_score < 4  %}
                        <p class="base-score" style="background-color:lightgreen"> <b style="font-size: 20px; ">Base Severity:  "{{ m.cvssv31.base_severity }}"</b> 
                        </p></br>
                        {% elif m.cvssv31.base_score >= 4 and m.cvssv31.base_score < 7 %}
                        <p class="base-score" style="background-color:yellow"> <b style="font-size: 20px; ">Base Severity:  "{{ m.cvssv31.base_severity }}"</b> 
                        </p></br>
                        {% elif m.cvssv31.base_score >= 7 and m.cvssv31.base_score < 9 %}
                        <p class="base-score" style="background-color:orange"> <b style="font-size: 20px; ">Base Severity:  "{{ m.cvssv31.base_severity }}"</b> 
                        </p></br>
                        {% else %}
                        <p class="base-score" style="background-color:red"> <b style="font-size: 20px; ">Base Severity:  "{{ m.cvssv31.base_severity }}"</b> 
                        </p></br>
                        {% endif %}
                        <p class="base-score"> <b style="font-size: 20px;">Attack Complexity: "{{ m.cvssv31.attackComplexity }}"</b>
                        </p></br>
                        <p class="base-score"> <b style="font-size: 20px;">Attack Vector: "{{ m.cvssv31.attackVector }}"</b>
                        </p></br>
                        <p class="base-score"> <b style="font-size: 20px;">Availability Impact: "{{ m.cvssv31.availabilityImpact }}"</b> 
                        </p></br>
                        <p class="base-score"> <b style="font-size: 20px;">Confidentiality Impact: "{{ m.cvssv31.confidentialityImpact }}"</b> 
                        </p></br>
                        <p class="base-score"> <b style="font-size: 20px;">Integrity Impact: "{{ m.cvssv31.integrityImpact }}"</b>
                        </p></br>
                        <p class="base-score"> <b style="font-size: 20px;">Privileges Required: "{{ m.cvssv31.privilegesRequired }}"</b>
                        </p></br>
                        <p class="base-score"> <b style="font-size: 20px;">Scope Of: "{{ m.cvssv31.scope }}"</b> 
                        </p></br>
                        <p class="base-score"> <b style="font-size: 20px;">User Interaction: "{{ m.cvssv31.userInteraction }}"</b> 
                        </p></br>
                    {% endif %}
                {% endfor %}
                </div>      
            </br>
                <button class="accordion"><b>CVSS V3.0</b></button>
                    <div class="panel">
                        {% for m in metric %}
                        {% if m.con_id == detail_cve.id  and m.cvssv30.base_score is not none and m.cvssv30.base_severity is not none%}
                    </br>
                            <p class="base-score"> <b style="font-size: 20px;">Base Score: "{{ m.cvssv30.base_score }}"</b> 
                            </p></br>
                            <p class="base-score"> <b style="font-size: 20px;">Vector String: "{{ m.cvssv30.vector_string }}"</b> 
                            </p></br>
                            {% if m.cvssv30.base_score > 0 and m.cvssv30.base_score < 4  %}
                            <p class="base-score" style="background-color:lightgreen"> <b style="font-size: 20px; ">Base Severity:  "{{ m.cvssv30.base_severity }}"</b> 
                            </p></br>
                            {% elif m.cvssv30.base_score >= 4 and m.cvssv30.base_score < 7 %}
                            <p class="base-score" style="background-color:yellow"> <b style="font-size: 20px; ">Base Severity:  "{{ m.cvssv30.base_severity }}"</b> 
                            </p></br>
                            {% elif m.cvssv30.base_score >= 7 and m.cvssv30.base_score < 9 %}
                            <p class="base-score" style="background-color:orange"> <b style="font-size: 20px; ">Base Severity:  "{{ m.cvssv30.base_severity }}"</b> 
                            </p></br>
                            {% else %}
                            <p class="base-score" style="background-color:red"> <b style="font-size: 20px; ">Base Severity:  "{{ m.cvssv30.base_severity }}"</b> 
                            </p></br>
                            {% endif %}
                        
                        {% endif %}
                    {% endfor %}
                    </div>
                </br>
                    <button class="accordion"><b>CVSS V2.0</b></button>
                    <div class="panel">
                        {% for m in metric %}
                        {% if m.con_id == detail_cve.id  and m.cvssv20.base_score is not none %}
                    </br>
                            <p class="base-score"> <b style="font-size: 20px;">Base Score: "{{ m.cvssv20.base_score }}"</b> 
                            </p></br>
                            <p class="base-score"> <b style="font-size: 20px;">Vector String: "{{ m.cvssv20.vector_string }}"</b> 
                            </p></br>
                            {% if m.cvssv20.base_score > 0 and m.cvssv20.base_score < 4  %}
                            <p class="base-score" style="background-color:lightgreen"> <b style="font-size: 20px; ">Base Severity:  "LOW"</b> 
                            </p></br>
                            {% elif m.cvssv20.base_score >= 4 and m.cvssv20.base_score < 7 %}
                            <p class="base-score" style="background-color:yellow"> <b style="font-size: 20px; ">Base Severity:  "MEDIUM"</b> 
                            </p></br>
                            {% elif m.cvssv20.base_score >= 7 and m.cvssv20.base_score < 9 %}
                            <p class="base-score" style="background-color:orange"> <b style="font-size: 20px; ">Base Severity:  "HIGH"</b> 
                            </p></br>
                            {% else %}
                            <p class="base-score" style="background-color:red"> <b style="font-size: 20px; ">Base Severity:  "CRITICAL"</b> 
                            </p></br>
                            {% endif %}
                            
                      {% comment %} {% elif m.con_id == detail_cve.id and m.cvssv20.base_score is none and m.cvssv20.base_score < 0 or m.cvssv20.base_score > 10%}  
                      <p class="base-score"> <b style="font-size: 20px;">NOT UPDATED!</b> 
                      </p></br>   {% endcomment %}
                    
                            {% endif %}
                    {% endfor %}
                    </div>
            <script>
                var acc = document.getElementsByClassName("accordion");
                var i;
                
                for (i = 0; i < acc.length; i++) {
                  acc[i].addEventListener("click", function() {
                    this.classList.toggle("active");
                    var panel = this.nextElementSibling;
                    if (panel.style.maxHeight) {
                      panel.style.maxHeight = null;
                    } else {
                      panel.style.maxHeight = panel.scrollHeight + "px";
                    } 
                  });
                }
                </script>
        </div>
    </div>
</div>
<script>
  // Lắng nghe sự kiện click trên tất cả các thẻ 'a' có class 'product-link'
  document.querySelectorAll('.product-link').forEach(link => {
      link.addEventListener('click', function(event) {
          event.preventDefault(); // Ngăn chặn hành động mặc định của thẻ 'a'

          const productName = this.getAttribute('data-product-name'); // Lấy tên sản phẩm từ thuộc tính 'data-product-name' của thẻ 'a'

          // Lưu giá trị vào localStorage với khóa là "click_product"
          localStorage.setItem('click_product', JSON.stringify(productName));

          // Đặt giá trị cho input ẩn trong form
          document.getElementById('click_product_input').value = JSON.stringify(productName);

          // Submit form
          document.getElementById('click_product_form').submit();
      });
  });
</script>

<script>
  // Lắng nghe sự kiện click trên tất cả các thẻ 'a' có class 'product-link'
  document.querySelectorAll('.problem-link').forEach(link => {
      link.addEventListener('click', function(event) {
          event.preventDefault(); // Ngăn chặn hành động mặc định của thẻ 'a'

          const productName = this.getAttribute('data-problem-name'); // Lấy tên sản phẩm từ thuộc tính 'data-product-name' của thẻ 'a'

          // Lưu giá trị vào localStorage với khóa là "click_product"
          localStorage.setItem('click_problem', JSON.stringify(productName));

          // Đặt giá trị cho input ẩn trong form
          document.getElementById('click_problem_input').value = JSON.stringify(productName);

          // Submit form
          document.getElementById('click_problem_form').submit();
      });
  });
</script>
{% endblock %}